<?xml version="1.0" encoding="utf-8"?>
<tlwl:Workflow xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mca="clr-namespace:Microsoft.CSharp.Activities;assembly=System.Activities" xmlns:msdad="clr-namespace:Microsoft.SharePoint.DesignTime.Activities.Design;assembly=Microsoft.SharePoint.DesignTime.Activities.16.0.Design" xmlns:p="wf://workflow.windows.net/$Activities" xmlns:p1="http://schemas.microsoft.com/workflow/2012/07/xaml/activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:tlwl="clr-namespace:tora_asia.leaverequest.Workflows.LeaveReqeustWF;assembly=tora-asia.leaverequest" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Text</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>Microsoft.Activities</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>Microsoft.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.Activities.Design</AssemblyReference>
      <AssemblyReference>Microsoft.SharePoint.DesignTime.Activities.16.0</AssemblyReference>
      <AssemblyReference>Microsoft.SharePoint.DesignTime.Activities.16.0.Design</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>System.ServiceModel.Activities</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>tora-asia.leaverequest</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <tlwl:Workflow.Implementation>
    <StateMachine>
      <StateMachine.InitialState>
        <State x:Name="__ReferenceID4" DisplayName="Get List Info">
          <State.Entry>
            <p:AppOnlySequence>
              <p:AppOnlySequence.Body>
                <p:WriteToHistory Message="Workflow Start" />
              </p:AppOnlySequence.Body>
            </p:AppOnlySequence>
          </State.Entry>
          <State.Exit>
            <p:AppOnlySequence>
              <p:AppOnlySequence.Body>
                <Sequence>
                  <Sequence.Variables>
                    <Variable x:TypeArguments="x:String" Name="currentListName" />
                  </Sequence.Variables>
                  <p:LookupWorkflowContextProperty DisplayName="Get Current Site Url" PropertyName="CurrentWebUrl">
                    <p:LookupWorkflowContextProperty.Result>
                      <OutArgument x:TypeArguments="x:String">
                        <mca:CSharpReference x:TypeArguments="x:String">CurrentSiteUrl</mca:CSharpReference>
                      </OutArgument>
                    </p:LookupWorkflowContextProperty.Result>
                  </p:LookupWorkflowContextProperty>
                  <p:GetCurrentItemId DisplayName="Get Current Item ID">
                    <p:GetCurrentItemId.Result>
                      <OutArgument x:TypeArguments="x:Int32">
                        <mca:CSharpReference x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpReference>
                      </OutArgument>
                    </p:GetCurrentItemId.Result>
                  </p:GetCurrentItemId>
                  <p:LookupWorkflowContextProperty DisplayName="Get Current List ID" PropertyName="ListId">
                    <p:LookupWorkflowContextProperty.Result>
                      <OutArgument x:TypeArguments="x:String">
                        <mca:CSharpReference x:TypeArguments="x:String">CurrentListID</mca:CSharpReference>
                      </OutArgument>
                    </p:LookupWorkflowContextProperty.Result>
                  </p:LookupWorkflowContextProperty>
                  <p:LookupWorkflowContextProperty DisplayName="Get Current List Name" PropertyName="ListName">
                    <p:LookupWorkflowContextProperty.Result>
                      <OutArgument x:TypeArguments="x:String">
                        <mca:CSharpReference x:TypeArguments="x:String">currentListName</mca:CSharpReference>
                      </OutArgument>
                    </p:LookupWorkflowContextProperty.Result>
                  </p:LookupWorkflowContextProperty>
                  <Assign>
                    <Assign.To>
                      <OutArgument x:TypeArguments="s:Guid">
                        <mca:CSharpReference x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpReference>
                      </OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="s:Guid">
                        <mca:CSharpValue x:TypeArguments="s:Guid">new Guid(CurrentListID)</mca:CSharpValue>
                      </InArgument>
                    </Assign.Value>
                  </Assign>
                  <p:WriteToHistory>
                    <p:WriteToHistory.Message>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" xml:space="preserve">"List : "+CurrentListID+"\r\n"+
"ItemID : "+CurrentItemID</mca:CSharpValue>
                      </InArgument>
                    </p:WriteToHistory.Message>
                  </p:WriteToHistory>
                </Sequence>
              </p:AppOnlySequence.Body>
            </p:AppOnlySequence>
          </State.Exit>
          <State.Transitions>
            <Transition DisplayName="T1">
              <Transition.To>
                <State x:Name="__ReferenceID6" DisplayName="Get RequestType">
                  <State.Entry>
                    <Sequence>
                      <Sequence.Variables>
                        <Variable x:TypeArguments="p1:DynamicValue" Name="dv_0" />
                      </Sequence.Variables>
                      <p:LookupSPListItem ItemGuid="{x:Null}" Properties="{x:Null}">
                        <p:LookupSPListItem.ItemId>
                          <InArgument x:TypeArguments="x:Int32">
                            <mca:CSharpValue x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpValue>
                          </InArgument>
                        </p:LookupSPListItem.ItemId>
                        <p:LookupSPListItem.ListId>
                          <InArgument x:TypeArguments="s:Guid">
                            <mca:CSharpValue x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpValue>
                          </InArgument>
                        </p:LookupSPListItem.ListId>
                        <p:LookupSPListItem.Result>
                          <OutArgument x:TypeArguments="p1:DynamicValue">
                            <mca:CSharpReference x:TypeArguments="p1:DynamicValue">dv_0</mca:CSharpReference>
                          </OutArgument>
                        </p:LookupSPListItem.Result>
                      </p:LookupSPListItem>
                      <p1:GetODataProperties DisplayName="GetDynamicValueProperties">
                        <p1:GetODataProperties.Source>
                          <InArgument x:TypeArguments="p1:DynamicValue">
                            <mca:CSharpValue x:TypeArguments="p1:DynamicValue">dv_0</mca:CSharpValue>
                          </InArgument>
                        </p1:GetODataProperties.Source>
                        <scg:Dictionary x:TypeArguments="x:String, OutArgument">
                          <OutArgument x:TypeArguments="x:String" x:Key="RequestType">
                            <mca:CSharpReference x:TypeArguments="x:String">RequestType</mca:CSharpReference>
                          </OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="CurrentAppUrl">
                            <mca:CSharpReference x:TypeArguments="x:String">CurrentAppUrl</mca:CSharpReference>
                          </OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="CurrentHostUrl">
                            <mca:CSharpReference x:TypeArguments="x:String">CurrentHostUrl</mca:CSharpReference>
                          </OutArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="CurrentUrl">
                            <mca:CSharpReference x:TypeArguments="x:String">CurrentUrl</mca:CSharpReference>
                          </OutArgument>
                        </scg:Dictionary>
                      </p1:GetODataProperties>
                      <p:WriteToHistory>
                        <p:WriteToHistory.Message>
                          <InArgument x:TypeArguments="x:String">
                            <mca:CSharpValue x:TypeArguments="x:String" xml:space="preserve">CurrentUrl+"\r\n"+
CurrentHostUrl + "\r\n"+
CurrentAppUrl + "\r\n"</mca:CSharpValue>
                          </InArgument>
                        </p:WriteToHistory.Message>
                      </p:WriteToHistory>
                    </Sequence>
                  </State.Entry>
                  <State.Transitions>
                    <Transition DisplayName="T5">
                      <Transition.Condition>
                        <mca:CSharpValue x:TypeArguments="x:Boolean">RequestType.ToLower().Equals("new") || RequestType.ToLower().Equals("1")</mca:CSharpValue>
                      </Transition.Condition>
                      <Transition.To>
                        <State x:Name="__ReferenceID5" DisplayName="Set Status to Inprogress (New)">
                          <State.Entry>
                            <Sequence>
                              <p:AppOnlySequence>
                                <p:AppOnlySequence.Body>
                                  <Sequence>
                                    <p:WriteToHistory Message="Request : New" />
                                    <p:UpdateListItem ItemGuid="{x:Null}" ListItemProperties="{x:Null}">
                                      <p:UpdateListItem.ItemId>
                                        <InArgument x:TypeArguments="x:Int32">
                                          <mca:CSharpValue x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpValue>
                                        </InArgument>
                                      </p:UpdateListItem.ItemId>
                                      <p:UpdateListItem.ListId>
                                        <InArgument x:TypeArguments="s:Guid">
                                          <mca:CSharpValue x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpValue>
                                        </InArgument>
                                      </p:UpdateListItem.ListId>
                                      <p:UpdateListItem.ListItemPropertiesDynamicValue>
                                        <InArgument x:TypeArguments="p1:DynamicValue">
                                          <p1:SetDynamicValueProperties>
                                            <scg:Dictionary x:TypeArguments="x:String, InArgument">
                                              <InArgument x:TypeArguments="x:String" x:Key="LeaveStatus">In Progress</InArgument>
                                            </scg:Dictionary>
                                          </p1:SetDynamicValueProperties>
                                        </InArgument>
                                      </p:UpdateListItem.ListItemPropertiesDynamicValue>
                                    </p:UpdateListItem>
                                    <p1:SetUserStatus Description="In Progress" DisplayName="Set In Progress" />
                                  </Sequence>
                                </p:AppOnlySequence.Body>
                              </p:AppOnlySequence>
                              <Assign>
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String">ApproveStatus</mca:CSharpReference>
                                  </OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">In Progress</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </State.Entry>
                          <State.Transitions>
                            <Transition DisplayName="T2">
                              <Transition.To>
                                <State x:Name="__ReferenceID3" DisplayName="Get Item Information">
                                  <State.Exit>
                                    <p:AppOnlySequence>
                                      <p:AppOnlySequence.Body>
                                        <Sequence>
                                          <Sequence.Variables>
                                            <Variable x:TypeArguments="p1:DynamicValue" Name="listItemProps" />
                                            <Variable x:TypeArguments="sco:Collection(x:Int32)" Name="testCollectionInt" />
                                            <Variable x:TypeArguments="x:String" Name="hrarray" />
                                          </Sequence.Variables>
                                          <p:WriteToHistory Message="Step Get Information" />
                                          <p:LookupSPListItem ItemGuid="{x:Null}" Properties="{x:Null}">
                                            <p:LookupSPListItem.ItemId>
                                              <InArgument x:TypeArguments="x:Int32">
                                                <mca:CSharpValue x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpValue>
                                              </InArgument>
                                            </p:LookupSPListItem.ItemId>
                                            <p:LookupSPListItem.ListId>
                                              <InArgument x:TypeArguments="s:Guid">
                                                <mca:CSharpValue x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpValue>
                                              </InArgument>
                                            </p:LookupSPListItem.ListId>
                                            <p:LookupSPListItem.Result>
                                              <OutArgument x:TypeArguments="p1:DynamicValue">
                                                <mca:CSharpReference x:TypeArguments="p1:DynamicValue">listItemProps</mca:CSharpReference>
                                              </OutArgument>
                                            </p:LookupSPListItem.Result>
                                          </p:LookupSPListItem>
                                          <p1:GetODataProperties DisplayName="GetDynamicValueProperties">
                                            <p1:GetODataProperties.Source>
                                              <InArgument x:TypeArguments="p1:DynamicValue">
                                                <mca:CSharpValue x:TypeArguments="p1:DynamicValue">listItemProps</mca:CSharpValue>
                                              </InArgument>
                                            </p1:GetODataProperties.Source>
                                            <scg:Dictionary x:TypeArguments="x:String, OutArgument">
                                              <OutArgument x:TypeArguments="x:String" x:Key="OfficerApproverStringId">
                                                <mca:CSharpReference x:TypeArguments="x:String">OfficerManager</mca:CSharpReference>
                                              </OutArgument>
                                              <OutArgument x:TypeArguments="p1:DynamicValue" x:Key="OfficerHrStringId">
                                                <mca:CSharpReference x:TypeArguments="p1:DynamicValue">dynamichr</mca:CSharpReference>
                                              </OutArgument>
                                              <OutArgument x:TypeArguments="x:String" x:Key="Title">
                                                <mca:CSharpReference x:TypeArguments="x:String">Title</mca:CSharpReference>
                                              </OutArgument>
                                              <OutArgument x:TypeArguments="x:String" x:Key="LeaveType">
                                                <mca:CSharpReference x:TypeArguments="x:String">LeaveType</mca:CSharpReference>
                                              </OutArgument>
                                              <OutArgument x:TypeArguments="x:Double" x:Key="LeaveDayTotal">
                                                <mca:CSharpReference x:TypeArguments="x:Double">NumberOfDay</mca:CSharpReference>
                                              </OutArgument>
                                              <OutArgument x:TypeArguments="x:String" x:Key="LeaveStatus">
                                                <mca:CSharpReference x:TypeArguments="x:String">LeaveStatus</mca:CSharpReference>
                                              </OutArgument>
                                              <OutArgument x:TypeArguments="x:String" x:Key="RequesterStringId">
                                                <mca:CSharpReference x:TypeArguments="x:String">RequesterId</mca:CSharpReference>
                                              </OutArgument>
                                            </scg:Dictionary>
                                          </p1:GetODataProperties>
                                          <If>
                                            <If.Condition>
                                              <InArgument x:TypeArguments="x:Boolean">
                                                <mca:CSharpValue x:TypeArguments="x:Boolean">dynamichr != null</mca:CSharpValue>
                                              </InArgument>
                                            </If.Condition>
                                            <If.Then>
                                              <Sequence>
                                                <p1:GetODataProperties DisplayName="GetDynamicValueProperties">
                                                  <p1:GetODataProperties.Source>
                                                    <InArgument x:TypeArguments="p1:DynamicValue">
                                                      <mca:CSharpValue x:TypeArguments="p1:DynamicValue">dynamichr</mca:CSharpValue>
                                                    </InArgument>
                                                  </p1:GetODataProperties.Source>
                                                  <scg:Dictionary x:TypeArguments="x:String, OutArgument">
                                                    <OutArgument x:TypeArguments="sco:Collection(x:String)" x:Key="results">
                                                      <mca:CSharpReference x:TypeArguments="sco:Collection(x:String)">listHrApprove</mca:CSharpReference>
                                                    </OutArgument>
                                                  </scg:Dictionary>
                                                </p1:GetODataProperties>
                                                <p:WriteToHistory>
                                                  <p:WriteToHistory.Message>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">dynamichr.ToString()</mca:CSharpValue>
                                                    </InArgument>
                                                  </p:WriteToHistory.Message>
                                                </p:WriteToHistory>
                                              </Sequence>
                                            </If.Then>
                                          </If>
                                          <p:WriteToHistory>
                                            <p:WriteToHistory.Message>
                                              <InArgument x:TypeArguments="x:String">
                                                <mca:CSharpValue x:TypeArguments="x:String" xml:space="preserve">"RequesterId ID in Get Info : " + RequesterId +
"\r\nManager ID in Get Info : " +OfficerManager+
"\r\nHR ID in Get Info : " + listHrApprove.Count</mca:CSharpValue>
                                              </InArgument>
                                            </p:WriteToHistory.Message>
                                          </p:WriteToHistory>
                                        </Sequence>
                                      </p:AppOnlySequence.Body>
                                    </p:AppOnlySequence>
                                  </State.Exit>
                                  <State.Transitions>
                                    <Transition DisplayName="T3">
                                      <Transition.Condition>
                                        <mca:CSharpValue x:TypeArguments="x:Boolean">RequestType.ToLower().Equals("new") || RequestType.ToLower().Equals("1")</mca:CSharpValue>
                                      </Transition.Condition>
                                      <Transition.To>
                                        <State x:Name="__ReferenceID8" DisplayName="Manager Title Body (New)">
                                          <State.Entry>
                                            <Sequence>
                                              <Sequence DisplayName="Manager">
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">TitleManagerEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">"แจ้งการขออนุมัติการลาของ " + Title</mca:CSharpValue>
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">BodyManagerEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">"กรุณาพิจารณา การลา " + LeaveType + " ของ " +Title</mca:CSharpValue>
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Sequence DisplayName="Requester">
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">TitleRequesterEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">แจ้งผลการขออนุมัติการลา</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">BodyRequesterEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">ผู้อนุมัติได้พิจารณา </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Sequence DisplayName="HR">
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">TitleHREmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">"Review : แจ้งผลการขออนุมัติการลาของ "+Title</mca:CSharpValue>
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">BodyHrEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">"ตามที่ "+ Title + "ได้ขออนุมัติการลา "+LeaveType+" โดยมีผลการพิจารณา คือ "</mca:CSharpValue>
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                            </Sequence>
                                          </State.Entry>
                                          <State.Transitions>
                                            <Transition DisplayName="T11">
                                              <Transition.To>
                                                <State x:Name="__ReferenceID2" DisplayName="Send  Task">
                                                  <State.Entry>
                                                    <Sequence>
                                                      <Assign>
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">
                                                            <mca:CSharpReference x:TypeArguments="x:Int32">iscancelstate</mca:CSharpReference>
                                                          </OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign>
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Boolean">
                                                            <mca:CSharpReference x:TypeArguments="x:Boolean">iscompleteParallel</mca:CSharpReference>
                                                          </OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Parallel>
                                                        <Parallel.CompletionCondition>
                                                          <mca:CSharpValue x:TypeArguments="x:Boolean">iscompleteParallel</mca:CSharpValue>
                                                        </Parallel.CompletionCondition>
                                                        <TryCatch>
                                                          <TryCatch.Variables>
                                                            <Variable x:TypeArguments="x:Int32" Name="errorindex" />
                                                            <Variable x:TypeArguments="x:Int32" Name="errormax" />
                                                            <Variable x:TypeArguments="x:Int32" Name="errorlen" />
                                                          </TryCatch.Variables>
                                                          <TryCatch.Try>
                                                            <p:AppOnlySequence DisplayName="AppOnlySequence Task to Controller">
                                                              <p:AppOnlySequence.Body>
                                                                <Sequence>
                                                                  <p:WriteToHistory>
                                                                    <p:WriteToHistory.Message>
                                                                      <InArgument x:TypeArguments="x:String">
                                                                        <mca:CSharpValue x:TypeArguments="x:String" xml:space="preserve">"--Manager ID in Send Task : "+OfficerManager+
"--HR ID in Send Task : " + listHrApprove.Count +
"--Title in Send Task : " + Title + 
"--LeaveStatus in Send Task : " + LeaveStatus + 
"--LeaveType in Send Task : " + LeaveType</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </p:WriteToHistory.Message>
                                                                  </p:WriteToHistory>
                                                                  <p1:BuildCollection x:TypeArguments="x:String">
                                                                    <p1:BuildCollection.Result>
                                                                      <OutArgument x:TypeArguments="sco:Collection(x:String)">
                                                                        <mca:CSharpReference x:TypeArguments="sco:Collection(x:String)">EmailToRequester</mca:CSharpReference>
                                                                      </OutArgument>
                                                                    </p1:BuildCollection.Result>
                                                                    <p1:BuildCollection.Values>
                                                                      <InArgument x:TypeArguments="x:String">
                                                                        <mca:CSharpValue x:TypeArguments="x:String">RequesterId</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </p1:BuildCollection.Values>
                                                                  </p1:BuildCollection>
                                                                  <If>
                                                                    <If.Condition>
                                                                      <InArgument x:TypeArguments="x:Boolean">
                                                                        <mca:CSharpValue x:TypeArguments="x:Boolean">!string.IsNullOrEmpty(OfficerManager)</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </If.Condition>
                                                                    <If.Then>
                                                                      <Sequence>
                                                                        <Sequence.Variables>
                                                                          <Variable x:TypeArguments="x:Int32" Name="outcome_0" />
                                                                          <Variable x:TypeArguments="x:Int32" Name="outcome_1" />
                                                                        </Sequence.Variables>
                                                                        <p:WriteToHistory Message="Start send task" />
                                                                        <p:WriteToHistory>
                                                                          <p:WriteToHistory.Message>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String">TitleManagerEmail</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:WriteToHistory.Message>
                                                                        </p:WriteToHistory>
                                                                        <p:WriteToHistory>
                                                                          <p:WriteToHistory.Message>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String">BodyManagerEmail</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:WriteToHistory.Message>
                                                                        </p:WriteToHistory>
                                                                        <p:SingleTask DueDate="{x:Null}" TaskId="{x:Null}" TaskItemId="{x:Null}" CancelationEmailBody="เนื่องจากผู้ขออนุมัติได้ยกเลิกการขออนุมัติการลา จึงแจ้งมาเพื่อทราบ&lt;br/&gt;" CompletedStatus="Completed" ContentTypeId="0x0108003365C4474CAE8C42BCE396314E88E51F" DefaultTaskOutcome="0" OutcomeFieldName="TaskOutcome" OverdueEmailBody="&lt;html&gt;&lt;body style='font-size:11pt;font-family:Segoe UI Light,sans-serif;color:#444444;'&gt;&lt;div&gt;&lt;span style='font-size:13.5pt'&gt;You have an &lt;/span&gt;&lt;span style='font-size:13.5pt;color:#ff3b3b;'&gt;overdue&lt;/span&gt;&lt;span style='font-size:13.5pt'&gt; task.&lt;/span&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;" OverdueEmailSubject="Task Overdue" OverdueReminderRepeat="1" OverdueRepeatTimes="1" PreserveIncompleteTasks="False" SendReminderEmail="True" WaitForTaskCompletion="True" WaiveAssignmentEmail="False" WaiveCancelationEmail="False">
                                                                          <p:SingleTask.AssignedTo>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String">OfficerManager</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.AssignedTo>
                                                                          <p:SingleTask.AssignmentEmailBody>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String" xml:space="preserve">BodyManagerEmail + "  " + "&lt;a href='" + CurrentUrl + "?SPHostUrl=" + CurrentHostUrl + "&amp;SPAppWebUrl=" + CurrentAppUrl + "&amp;CaseView=0&amp;CurItemId=" + CurrentItemID + "&amp;TaskUrl=%TaskSpecial: TaskUrl%'&gt;รายละเอียด&lt;/a&gt;&lt;br/&gt;"</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.AssignmentEmailBody>
                                                                          <p:SingleTask.AssignmentEmailSubject>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String">TitleManagerEmail</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.AssignmentEmailSubject>
                                                                          <p:SingleTask.Body>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String">BodyManagerEmail</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.Body>
                                                                          <p:SingleTask.CancelationEmailSubject>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String">"แจ้งยกเลิกการขออนุมัติการลาของ " + Title</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.CancelationEmailSubject>
                                                                          <p:SingleTask.Outcome>
                                                                            <OutArgument x:TypeArguments="x:Int32">
                                                                              <mca:CSharpReference x:TypeArguments="x:Int32">outcome_0</mca:CSharpReference>
                                                                            </OutArgument>
                                                                          </p:SingleTask.Outcome>
                                                                          <p:SingleTask.RelatedContentLinkListId>
                                                                            <InArgument x:TypeArguments="s:Guid">
                                                                              <p1:ExpressionContainerValue x:TypeArguments="s:Guid">
                                                                                <p:GetCurrentListId />
                                                                              </p1:ExpressionContainerValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.RelatedContentLinkListId>
                                                                          <p:SingleTask.RelatedContentLinkListItemId>
                                                                            <InArgument x:TypeArguments="s:Guid">
                                                                              <p1:ExpressionContainerValue x:TypeArguments="s:Guid">
                                                                                <p:GetCurrentItemGuid />
                                                                              </p1:ExpressionContainerValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.RelatedContentLinkListItemId>
                                                                          <p:SingleTask.RelatedContentLinkListItemIntegerId>
                                                                            <InArgument x:TypeArguments="x:Int32">
                                                                              <p1:ExpressionContainerValue x:TypeArguments="x:Int32">
                                                                                <p:GetCurrentItemId />
                                                                              </p1:ExpressionContainerValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.RelatedContentLinkListItemIntegerId>
                                                                          <p:SingleTask.Title>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String">TitleManagerEmail</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:SingleTask.Title>
                                                                        </p:SingleTask>
                                                                        <p:WriteToHistory>
                                                                          <p:WriteToHistory.Message>
                                                                            <InArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpValue x:TypeArguments="x:String">"Output :" + outcome_0.ToString()</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </p:WriteToHistory.Message>
                                                                        </p:WriteToHistory>
                                                                        <Sequence DisplayName="Check Status of Task">
                                                                          <If>
                                                                            <If.Condition>
                                                                              <InArgument x:TypeArguments="x:Boolean">
                                                                                <mca:CSharpValue x:TypeArguments="x:Boolean">outcome_0 == 0</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </If.Condition>
                                                                            <If.Then>
                                                                              <Sequence>
                                                                                <If>
                                                                                  <If.Condition>
                                                                                    <InArgument x:TypeArguments="x:Boolean">
                                                                                      <mca:CSharpValue x:TypeArguments="x:Boolean">RequestType.ToLower().Equals("new") || RequestType.ToLower().Equals("1")</mca:CSharpValue>
                                                                                    </InArgument>
                                                                                  </If.Condition>
                                                                                  <If.Then>
                                                                                    <Sequence>
                                                                                      <Assign>
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">
                                                                                            <mca:CSharpReference x:TypeArguments="x:String">setStatusRequest</mca:CSharpReference>
                                                                                          </OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">Approved</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </Sequence>
                                                                                  </If.Then>
                                                                                  <If.Else>
                                                                                    <Sequence>
                                                                                      <Assign>
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">
                                                                                            <mca:CSharpReference x:TypeArguments="x:String">setStatusRequest</mca:CSharpReference>
                                                                                          </OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">Cancelled</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </Sequence>
                                                                                  </If.Else>
                                                                                </If>
                                                                                <Assign>
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">
                                                                                      <mca:CSharpReference x:TypeArguments="x:String">ApproveStatus</mca:CSharpReference>
                                                                                    </OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">Approved</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </Sequence>
                                                                            </If.Then>
                                                                            <If.Else>
                                                                              <Sequence>
                                                                                <Assign>
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">
                                                                                      <mca:CSharpReference x:TypeArguments="x:String">setStatusRequest</mca:CSharpReference>
                                                                                    </OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">Rejected</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                                <Assign>
                                                                                  <Assign.To>
                                                                                    <OutArgument x:TypeArguments="x:String">
                                                                                      <mca:CSharpReference x:TypeArguments="x:String">ApproveStatus</mca:CSharpReference>
                                                                                    </OutArgument>
                                                                                  </Assign.To>
                                                                                  <Assign.Value>
                                                                                    <InArgument x:TypeArguments="x:String">Rejected</InArgument>
                                                                                  </Assign.Value>
                                                                                </Assign>
                                                                              </Sequence>
                                                                            </If.Else>
                                                                          </If>
                                                                        </Sequence>
                                                                      </Sequence>
                                                                    </If.Then>
                                                                    <If.Else>
                                                                      <Sequence>
                                                                        <p:WriteToHistory Message="No Manager" />
                                                                        <If>
                                                                          <If.Condition>
                                                                            <InArgument x:TypeArguments="x:Boolean">
                                                                              <mca:CSharpValue x:TypeArguments="x:Boolean">RequestType.ToLower().Equals("new")</mca:CSharpValue>
                                                                            </InArgument>
                                                                          </If.Condition>
                                                                          <If.Then>
                                                                            <Sequence>
                                                                              <Assign>
                                                                                <Assign.To>
                                                                                  <OutArgument x:TypeArguments="x:String">
                                                                                    <mca:CSharpReference x:TypeArguments="x:String">setStatusRequest</mca:CSharpReference>
                                                                                  </OutArgument>
                                                                                </Assign.To>
                                                                                <Assign.Value>
                                                                                  <InArgument x:TypeArguments="x:String">Approved</InArgument>
                                                                                </Assign.Value>
                                                                              </Assign>
                                                                            </Sequence>
                                                                          </If.Then>
                                                                          <If.Else>
                                                                            <Sequence>
                                                                              <Assign>
                                                                                <Assign.To>
                                                                                  <OutArgument x:TypeArguments="x:String">
                                                                                    <mca:CSharpReference x:TypeArguments="x:String">setStatusRequest</mca:CSharpReference>
                                                                                  </OutArgument>
                                                                                </Assign.To>
                                                                                <Assign.Value>
                                                                                  <InArgument x:TypeArguments="x:String">Cancelled</InArgument>
                                                                                </Assign.Value>
                                                                              </Assign>
                                                                            </Sequence>
                                                                          </If.Else>
                                                                        </If>
                                                                        <Assign>
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpReference x:TypeArguments="x:String">ApproveStatus</mca:CSharpReference>
                                                                            </OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="x:String">Approved</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                        <Assign>
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="x:String">
                                                                              <mca:CSharpReference x:TypeArguments="x:String">ExtraOwnApprove</mca:CSharpReference>
                                                                            </OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="x:String">(อนุมัติด้วยตนเอง)</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                      </Sequence>
                                                                    </If.Else>
                                                                  </If>
                                                                  <p:Email AdditionalHeaders="{x:Null}" BCC="{x:Null}" CC="{x:Null}">
                                                                    <p:Email.Body>
                                                                      <InArgument x:TypeArguments="x:String">
                                                                        <mca:CSharpValue x:TypeArguments="x:String">BodyRequesterEmail+ApproveStatus+ " การขออนุมัติของท่าน " + "&lt;a href='" + CurrentUrl + "?SPHostUrl=" + CurrentHostUrl + "&amp;SPAppWebUrl=" + CurrentAppUrl + "&amp;CaseView=1&amp;CurItemId=" + CurrentItemID + "'&gt;รายละเอียด&lt;/a&gt;&lt;br/&gt;"</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </p:Email.Body>
                                                                    <p:Email.Subject>
                                                                      <InArgument x:TypeArguments="x:String">
                                                                        <mca:CSharpValue x:TypeArguments="x:String">TitleRequesterEmail+ExtraOwnApprove</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </p:Email.Subject>
                                                                    <p:Email.To>
                                                                      <InArgument x:TypeArguments="sco:Collection(x:String)">
                                                                        <mca:CSharpValue x:TypeArguments="sco:Collection(x:String)">EmailToRequester</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </p:Email.To>
                                                                  </p:Email>
                                                                  <Assign>
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Boolean">
                                                                        <mca:CSharpReference x:TypeArguments="x:Boolean">iscompleteParallel</mca:CSharpReference>
                                                                      </OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                </Sequence>
                                                              </p:AppOnlySequence.Body>
                                                            </p:AppOnlySequence>
                                                          </TryCatch.Try>
                                                          <TryCatch.Catches>
                                                            <Catch x:TypeArguments="s:Exception">
                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                </ActivityAction.Argument>
                                                                <Sequence>
                                                                  <p:WriteToHistory>
                                                                    <p:WriteToHistory.Message>
                                                                      <InArgument x:TypeArguments="x:String">
                                                                        <mca:CSharpValue x:TypeArguments="x:String">"Error In Send Task :"+exception.ToString().Length</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </p:WriteToHistory.Message>
                                                                  </p:WriteToHistory>
                                                                  <Assign>
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">
                                                                        <mca:CSharpReference x:TypeArguments="x:Int32">errorindex</mca:CSharpReference>
                                                                      </OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <Assign>
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">
                                                                        <mca:CSharpReference x:TypeArguments="x:Int32">errormax</mca:CSharpReference>
                                                                      </OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">240</InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <Assign>
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="x:Int32">
                                                                        <mca:CSharpReference x:TypeArguments="x:Int32">errorlen</mca:CSharpReference>
                                                                      </OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="x:Int32">
                                                                        <mca:CSharpValue x:TypeArguments="x:Int32">exception.ToString().Length</mca:CSharpValue>
                                                                      </InArgument>
                                                                    </Assign.Value>
                                                                  </Assign>
                                                                  <While>
                                                                    <While.Condition>
                                                                      <mca:CSharpValue x:TypeArguments="x:Boolean">errorindex &lt; exception.ToString().Length;</mca:CSharpValue>
                                                                    </While.Condition>
                                                                    <Sequence>
                                                                      <If>
                                                                        <If.Condition>
                                                                          <InArgument x:TypeArguments="x:Boolean">
                                                                            <mca:CSharpValue x:TypeArguments="x:Boolean">(errorlen-errorindex) &gt; errormax</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </If.Condition>
                                                                        <If.Then>
                                                                          <p:WriteToHistory>
                                                                            <p:WriteToHistory.Message>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <mca:CSharpValue x:TypeArguments="x:String">exception.ToString().Substring(errorindex,errormax)</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </p:WriteToHistory.Message>
                                                                          </p:WriteToHistory>
                                                                        </If.Then>
                                                                        <If.Else>
                                                                          <p:WriteToHistory>
                                                                            <p:WriteToHistory.Message>
                                                                              <InArgument x:TypeArguments="x:String">
                                                                                <mca:CSharpValue x:TypeArguments="x:String">exception.ToString().Substring(errorindex,(errorlen-errorindex))</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </p:WriteToHistory.Message>
                                                                          </p:WriteToHistory>
                                                                        </If.Else>
                                                                      </If>
                                                                      <Assign>
                                                                        <Assign.To>
                                                                          <OutArgument x:TypeArguments="x:Int32">
                                                                            <mca:CSharpReference x:TypeArguments="x:Int32">errorindex</mca:CSharpReference>
                                                                          </OutArgument>
                                                                        </Assign.To>
                                                                        <Assign.Value>
                                                                          <InArgument x:TypeArguments="x:Int32">
                                                                            <mca:CSharpValue x:TypeArguments="x:Int32">errorindex+errormax</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </Assign.Value>
                                                                      </Assign>
                                                                    </Sequence>
                                                                  </While>
                                                                  <p1:SetUserStatus Description="Terminate" />
                                                                  <TerminateWorkflow Reason="Terminate because error" />
                                                                </Sequence>
                                                              </ActivityAction>
                                                            </Catch>
                                                          </TryCatch.Catches>
                                                        </TryCatch>
                                                        <p:AppOnlySequence>
                                                          <p:AppOnlySequence.Body>
                                                            <Sequence>
                                                              <p:WaitForFieldChange EventPayload="{x:Null}" ItemGuid="{x:Null}" FieldName="CancelWorkflow" FieldValue="true">
                                                                <p:WaitForFieldChange.ItemId>
                                                                  <InArgument x:TypeArguments="x:Int32">
                                                                    <p1:ExpressionContainerValue x:TypeArguments="x:Int32">
                                                                      <p:GetCurrentItemId />
                                                                    </p1:ExpressionContainerValue>
                                                                  </InArgument>
                                                                </p:WaitForFieldChange.ItemId>
                                                                <p:WaitForFieldChange.ListId>
                                                                  <InArgument x:TypeArguments="s:Guid">
                                                                    <p1:ExpressionContainerValue x:TypeArguments="s:Guid">
                                                                      <p:GetCurrentListId />
                                                                    </p1:ExpressionContainerValue>
                                                                  </InArgument>
                                                                </p:WaitForFieldChange.ListId>
                                                              </p:WaitForFieldChange>
                                                              <p:WriteToHistory Message="Starting Teminate" />
                                                              <Assign>
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:Int32">
                                                                    <mca:CSharpReference x:TypeArguments="x:Int32">iscancelstate</mca:CSharpReference>
                                                                  </OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:Int32">1</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                              <Assign>
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:Boolean">
                                                                    <mca:CSharpReference x:TypeArguments="x:Boolean">iscompleteParallel</mca:CSharpReference>
                                                                  </OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                            </Sequence>
                                                          </p:AppOnlySequence.Body>
                                                        </p:AppOnlySequence>
                                                      </Parallel>
                                                    </Sequence>
                                                  </State.Entry>
                                                  <State.Transitions>
                                                    <Transition DisplayName="T4">
                                                      <Transition.Condition>
                                                        <mca:CSharpValue x:TypeArguments="x:Boolean">(RequestType.ToLower().Equals("new") || RequestType.ToLower().Equals("1")) &amp;&amp; iscancelstate == 0</mca:CSharpValue>
                                                      </Transition.Condition>
                                                      <Transition.To>
                                                        <State x:Name="__ReferenceID11" DisplayName="Set Status (New)">
                                                          <State.Entry>
                                                            <Sequence>
                                                              <p:AppOnlySequence>
                                                                <p:AppOnlySequence.Body>
                                                                  <Sequence>
                                                                    <p:WriteToHistory>
                                                                      <p:WriteToHistory.Message>
                                                                        <InArgument x:TypeArguments="x:String">
                                                                          <mca:CSharpValue x:TypeArguments="x:String">"Set Status to : "+setStatusRequest</mca:CSharpValue>
                                                                        </InArgument>
                                                                      </p:WriteToHistory.Message>
                                                                    </p:WriteToHistory>
                                                                    <p:UpdateListItem ItemGuid="{x:Null}" ListItemProperties="{x:Null}">
                                                                      <p:UpdateListItem.ItemId>
                                                                        <InArgument x:TypeArguments="x:Int32">
                                                                          <mca:CSharpValue x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpValue>
                                                                        </InArgument>
                                                                      </p:UpdateListItem.ItemId>
                                                                      <p:UpdateListItem.ListId>
                                                                        <InArgument x:TypeArguments="s:Guid">
                                                                          <mca:CSharpValue x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpValue>
                                                                        </InArgument>
                                                                      </p:UpdateListItem.ListId>
                                                                      <p:UpdateListItem.ListItemPropertiesDynamicValue>
                                                                        <InArgument x:TypeArguments="p1:DynamicValue">
                                                                          <p1:SetDynamicValueProperties>
                                                                            <scg:Dictionary x:TypeArguments="x:String, InArgument">
                                                                              <InArgument x:TypeArguments="x:String" x:Key="LeaveStatus">
                                                                                <mca:CSharpValue x:TypeArguments="x:String">setStatusRequest</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </scg:Dictionary>
                                                                          </p1:SetDynamicValueProperties>
                                                                        </InArgument>
                                                                      </p:UpdateListItem.ListItemPropertiesDynamicValue>
                                                                    </p:UpdateListItem>
                                                                    <p1:SetUserStatus DisplayName="Set In Progress">
                                                                      <p1:SetUserStatus.Description>
                                                                        <InArgument x:TypeArguments="x:String">
                                                                          <mca:CSharpValue x:TypeArguments="x:String">setStatusRequest</mca:CSharpValue>
                                                                        </InArgument>
                                                                      </p1:SetUserStatus.Description>
                                                                    </p1:SetUserStatus>
                                                                  </Sequence>
                                                                </p:AppOnlySequence.Body>
                                                              </p:AppOnlySequence>
                                                            </Sequence>
                                                          </State.Entry>
                                                          <State.Transitions>
                                                            <Transition DisplayName="T13">
                                                              <Transition.To>
                                                                <State x:Name="__ReferenceID0" DisplayName="HR Review">
                                                                  <State.Entry>
                                                                    <Sequence DisplayName="HR Review">
                                                                      <If>
                                                                        <If.Condition>
                                                                          <InArgument x:TypeArguments="x:Boolean">
                                                                            <mca:CSharpValue x:TypeArguments="x:Boolean">listHrApprove.Count &gt; 0 &amp;&amp; ApproveStatus.Equals("Approved")</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </If.Condition>
                                                                        <If.Then>
                                                                          <Sequence>
                                                                            <Sequence.Variables>
                                                                              <Variable x:TypeArguments="x:Int32" Name="outcom_hr" />
                                                                            </Sequence.Variables>
                                                                            <p:Email AdditionalHeaders="{x:Null}" BCC="{x:Null}" CC="{x:Null}">
                                                                              <p:Email.Body>
                                                                                <InArgument x:TypeArguments="x:String">
                                                                                  <mca:CSharpValue x:TypeArguments="x:String" xml:space="preserve">BodyHrEmail + ApproveStatus + "  " + "&lt;a href='" + CurrentUrl + "?SPHostUrl=" + CurrentHostUrl + "&amp;SPAppWebUrl=" + CurrentAppUrl + "&amp;CaseView=2&amp;CurItemId=" + CurrentItemID + "'&gt;รายละเอียด&lt;/a&gt;&lt;br/&gt;"</mca:CSharpValue>
                                                                                </InArgument>
                                                                              </p:Email.Body>
                                                                              <p:Email.Subject>
                                                                                <InArgument x:TypeArguments="x:String">
                                                                                  <mca:CSharpValue x:TypeArguments="x:String">TitleHREmail</mca:CSharpValue>
                                                                                </InArgument>
                                                                              </p:Email.Subject>
                                                                              <p:Email.To>
                                                                                <InArgument x:TypeArguments="sco:Collection(x:String)">
                                                                                  <mca:CSharpValue x:TypeArguments="sco:Collection(x:String)">listHrApprove</mca:CSharpValue>
                                                                                </InArgument>
                                                                              </p:Email.To>
                                                                            </p:Email>
                                                                            <p:WriteToHistory Message="Hr Reviewed" />
                                                                          </Sequence>
                                                                        </If.Then>
                                                                        <If.Else>
                                                                          <p:WriteToHistory Message="No Hr" />
                                                                        </If.Else>
                                                                      </If>
                                                                    </Sequence>
                                                                  </State.Entry>
                                                                  <State.Transitions>
                                                                    <Transition DisplayName="T8">
                                                                      <Transition.To>
                                                                        <State x:Name="__ReferenceID1" DisplayName="FinalState" IsFinal="True" />
                                                                      </Transition.To>
                                                                    </Transition>
                                                                  </State.Transitions>
                                                                </State>
                                                              </Transition.To>
                                                            </Transition>
                                                          </State.Transitions>
                                                        </State>
                                                      </Transition.To>
                                                    </Transition>
                                                    <Transition DisplayName="T12">
                                                      <Transition.Condition>
                                                        <mca:CSharpValue x:TypeArguments="x:Boolean">(RequestType.ToLower().Equals("cancel") || RequestType.ToLower().Equals("2") )&amp;&amp; iscancelstate == 0</mca:CSharpValue>
                                                      </Transition.Condition>
                                                      <Transition.To>
                                                        <State x:Name="__ReferenceID10" DisplayName="Set Status (Cancel)">
                                                          <State.Entry>
                                                            <Sequence>
                                                              <p:AppOnlySequence>
                                                                <p:AppOnlySequence.Body>
                                                                  <Sequence>
                                                                    <p:WriteToHistory>
                                                                      <p:WriteToHistory.Message>
                                                                        <InArgument x:TypeArguments="x:String">
                                                                          <mca:CSharpValue x:TypeArguments="x:String">"Set Status to : "+setStatusRequest</mca:CSharpValue>
                                                                        </InArgument>
                                                                      </p:WriteToHistory.Message>
                                                                    </p:WriteToHistory>
                                                                    <p:UpdateListItem ItemGuid="{x:Null}" ListItemProperties="{x:Null}">
                                                                      <p:UpdateListItem.ItemId>
                                                                        <InArgument x:TypeArguments="x:Int32">
                                                                          <mca:CSharpValue x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpValue>
                                                                        </InArgument>
                                                                      </p:UpdateListItem.ItemId>
                                                                      <p:UpdateListItem.ListId>
                                                                        <InArgument x:TypeArguments="s:Guid">
                                                                          <mca:CSharpValue x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpValue>
                                                                        </InArgument>
                                                                      </p:UpdateListItem.ListId>
                                                                      <p:UpdateListItem.ListItemPropertiesDynamicValue>
                                                                        <InArgument x:TypeArguments="p1:DynamicValue">
                                                                          <p1:SetDynamicValueProperties>
                                                                            <scg:Dictionary x:TypeArguments="x:String, InArgument">
                                                                              <InArgument x:TypeArguments="x:String" x:Key="CancelLeaveStatus">
                                                                                <mca:CSharpValue x:TypeArguments="x:String">setStatusRequest</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </scg:Dictionary>
                                                                          </p1:SetDynamicValueProperties>
                                                                        </InArgument>
                                                                      </p:UpdateListItem.ListItemPropertiesDynamicValue>
                                                                    </p:UpdateListItem>
                                                                    <p1:SetUserStatus DisplayName="Set In Progress">
                                                                      <p1:SetUserStatus.Description>
                                                                        <InArgument x:TypeArguments="x:String">
                                                                          <mca:CSharpValue x:TypeArguments="x:String">setStatusRequest</mca:CSharpValue>
                                                                        </InArgument>
                                                                      </p1:SetUserStatus.Description>
                                                                    </p1:SetUserStatus>
                                                                  </Sequence>
                                                                </p:AppOnlySequence.Body>
                                                              </p:AppOnlySequence>
                                                            </Sequence>
                                                          </State.Entry>
                                                          <State.Transitions>
                                                            <Transition DisplayName="T14" To="{x:Reference __ReferenceID0}" />
                                                          </State.Transitions>
                                                        </State>
                                                      </Transition.To>
                                                    </Transition>
                                                    <Transition DisplayName="T15">
                                                      <Transition.Condition>
                                                        <mca:CSharpValue x:TypeArguments="x:Boolean">iscancelstate == 1</mca:CSharpValue>
                                                      </Transition.Condition>
                                                      <Transition.To>
                                                        <State x:Name="__ReferenceID12" DisplayName="Set Status (Teminate)">
                                                          <State.Entry>
                                                            <Sequence>
                                                              <p:AppOnlySequence>
                                                                <p:AppOnlySequence.Body>
                                                                  <Sequence DisplayName="Set Status (Teminate">
                                                                    <Assign>
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">
                                                                          <mca:CSharpReference x:TypeArguments="x:String">setStatusRequest</mca:CSharpReference>
                                                                        </OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">Cancelled</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                    <Sequence>
                                                                      <p:WriteToHistory>
                                                                        <p:WriteToHistory.Message>
                                                                          <InArgument x:TypeArguments="x:String">
                                                                            <mca:CSharpValue x:TypeArguments="x:String">"Set Status to : "+setStatusRequest</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </p:WriteToHistory.Message>
                                                                      </p:WriteToHistory>
                                                                      <If>
                                                                        <If.Condition>
                                                                          <InArgument x:TypeArguments="x:Boolean">
                                                                            <mca:CSharpValue x:TypeArguments="x:Boolean">RequestType.ToLower().Equals("new")</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </If.Condition>
                                                                        <If.Then>
                                                                          <p:UpdateListItem ItemGuid="{x:Null}" ListItemProperties="{x:Null}">
                                                                            <p:UpdateListItem.ItemId>
                                                                              <InArgument x:TypeArguments="x:Int32">
                                                                                <mca:CSharpValue x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </p:UpdateListItem.ItemId>
                                                                            <p:UpdateListItem.ListId>
                                                                              <InArgument x:TypeArguments="s:Guid">
                                                                                <mca:CSharpValue x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </p:UpdateListItem.ListId>
                                                                            <p:UpdateListItem.ListItemPropertiesDynamicValue>
                                                                              <InArgument x:TypeArguments="p1:DynamicValue">
                                                                                <p1:SetDynamicValueProperties>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, InArgument">
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="LeaveStatus">
                                                                                      <mca:CSharpValue x:TypeArguments="x:String">setStatusRequest</mca:CSharpValue>
                                                                                    </InArgument>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="CancelLeaveStatus">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="CancelWorkflow">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </scg:Dictionary>
                                                                                </p1:SetDynamicValueProperties>
                                                                              </InArgument>
                                                                            </p:UpdateListItem.ListItemPropertiesDynamicValue>
                                                                          </p:UpdateListItem>
                                                                        </If.Then>
                                                                        <If.Else>
                                                                          <p:UpdateListItem ItemGuid="{x:Null}" ListItemProperties="{x:Null}">
                                                                            <p:UpdateListItem.ItemId>
                                                                              <InArgument x:TypeArguments="x:Int32">
                                                                                <mca:CSharpValue x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </p:UpdateListItem.ItemId>
                                                                            <p:UpdateListItem.ListId>
                                                                              <InArgument x:TypeArguments="s:Guid">
                                                                                <mca:CSharpValue x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpValue>
                                                                              </InArgument>
                                                                            </p:UpdateListItem.ListId>
                                                                            <p:UpdateListItem.ListItemPropertiesDynamicValue>
                                                                              <InArgument x:TypeArguments="p1:DynamicValue">
                                                                                <p1:SetDynamicValueProperties>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, InArgument">
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="CancelLeaveStatus">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                    <InArgument x:TypeArguments="x:String" x:Key="CancelWorkflow">
                                                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                                                    </InArgument>
                                                                                  </scg:Dictionary>
                                                                                </p1:SetDynamicValueProperties>
                                                                              </InArgument>
                                                                            </p:UpdateListItem.ListItemPropertiesDynamicValue>
                                                                          </p:UpdateListItem>
                                                                        </If.Else>
                                                                      </If>
                                                                      <p1:SetUserStatus DisplayName="Set In Cancelled">
                                                                        <p1:SetUserStatus.Description>
                                                                          <InArgument x:TypeArguments="x:String">
                                                                            <mca:CSharpValue x:TypeArguments="x:String">setStatusRequest</mca:CSharpValue>
                                                                          </InArgument>
                                                                        </p1:SetUserStatus.Description>
                                                                      </p1:SetUserStatus>
                                                                      <TerminateWorkflow Reason="Cancel by Requester" />
                                                                    </Sequence>
                                                                  </Sequence>
                                                                </p:AppOnlySequence.Body>
                                                              </p:AppOnlySequence>
                                                            </Sequence>
                                                          </State.Entry>
                                                          <State.Transitions>
                                                            <Transition DisplayName="T16" To="{x:Reference __ReferenceID1}" />
                                                          </State.Transitions>
                                                        </State>
                                                      </Transition.To>
                                                    </Transition>
                                                  </State.Transitions>
                                                  <State.Variables>
                                                    <Variable x:TypeArguments="sco:Collection(x:String)" Name="EmailToRequester" />
                                                    <Variable x:TypeArguments="x:String" Name="ExtraOwnApprove" />
                                                    <Variable x:TypeArguments="x:Int32" Name="iscancelstate" />
                                                    <Variable x:TypeArguments="x:Boolean" Name="iscompleteParallel" />
                                                  </State.Variables>
                                                </State>
                                              </Transition.To>
                                            </Transition>
                                          </State.Transitions>
                                        </State>
                                      </Transition.To>
                                    </Transition>
                                    <Transition DisplayName="T9">
                                      <Transition.Condition>
                                        <mca:CSharpValue x:TypeArguments="x:Boolean">RequestType.ToLower().Equals("cancel") || RequestType.ToLower().Equals("2")</mca:CSharpValue>
                                      </Transition.Condition>
                                      <Transition.To>
                                        <State x:Name="__ReferenceID9" DisplayName="Manager Title Body (Cancel)">
                                          <State.Entry>
                                            <Sequence>
                                              <Sequence DisplayName="Manager">
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">TitleManagerEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">"แจ้งการขออนุมัติยกเลิกการลาของ " + Title</mca:CSharpValue>
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">BodyManagerEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">"กรุณาพิจารณา ยกเลิกการลา " + LeaveType + " ของ " + Title</mca:CSharpValue>
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Sequence DisplayName="Requester">
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">TitleRequesterEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">แจ้งผลการขออนุมัติยกเลิกการลา</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">BodyRequesterEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String" xml:space="preserve">การขอยกเลิกการลา ผู้อนุมัติได้พิจารณา </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <Sequence DisplayName="HR">
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">TitleHREmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">"Review : แจ้งผลการขออนุมัติยกเลิกการลาของ " + Title</mca:CSharpValue>
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign>
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">
                                                      <mca:CSharpReference x:TypeArguments="x:String">BodyHrEmail</mca:CSharpReference>
                                                    </OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <mca:CSharpValue x:TypeArguments="x:String">"ตามที่ " + Title + "ได้ขออนุมัติยกเลิกการลา " + LeaveType + " โดยมีผลการพิจารณา คือ "</mca:CSharpValue>
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                            </Sequence>
                                          </State.Entry>
                                          <State.Transitions>
                                            <Transition DisplayName="T10" To="{x:Reference __ReferenceID2}" />
                                          </State.Transitions>
                                        </State>
                                      </Transition.To>
                                    </Transition>
                                  </State.Transitions>
                                </State>
                              </Transition.To>
                            </Transition>
                          </State.Transitions>
                        </State>
                      </Transition.To>
                    </Transition>
                    <Transition DisplayName="T6">
                      <Transition.Condition>
                        <mca:CSharpValue x:TypeArguments="x:Boolean">RequestType.ToLower().Equals("cancel")|| RequestType.ToLower().Equals("2")</mca:CSharpValue>
                      </Transition.Condition>
                      <Transition.To>
                        <State x:Name="__ReferenceID7" DisplayName="Set Status to Inprogress (Cancel)">
                          <State.Entry>
                            <Sequence>
                              <p:AppOnlySequence>
                                <p:AppOnlySequence.Body>
                                  <Sequence>
                                    <p:WriteToHistory Message="Request : Cancel" />
                                    <p:UpdateListItem ItemGuid="{x:Null}" ListItemProperties="{x:Null}">
                                      <p:UpdateListItem.ItemId>
                                        <InArgument x:TypeArguments="x:Int32">
                                          <mca:CSharpValue x:TypeArguments="x:Int32">CurrentItemID</mca:CSharpValue>
                                        </InArgument>
                                      </p:UpdateListItem.ItemId>
                                      <p:UpdateListItem.ListId>
                                        <InArgument x:TypeArguments="s:Guid">
                                          <mca:CSharpValue x:TypeArguments="s:Guid">CurrentListGUID</mca:CSharpValue>
                                        </InArgument>
                                      </p:UpdateListItem.ListId>
                                      <p:UpdateListItem.ListItemPropertiesDynamicValue>
                                        <InArgument x:TypeArguments="p1:DynamicValue">
                                          <p1:SetDynamicValueProperties>
                                            <scg:Dictionary x:TypeArguments="x:String, InArgument">
                                              <InArgument x:TypeArguments="x:String" x:Key="LeaveStatus">In Progress</InArgument>
                                            </scg:Dictionary>
                                          </p1:SetDynamicValueProperties>
                                        </InArgument>
                                      </p:UpdateListItem.ListItemPropertiesDynamicValue>
                                    </p:UpdateListItem>
                                    <p1:SetUserStatus Description="In Progress" DisplayName="Set In Progress" />
                                  </Sequence>
                                </p:AppOnlySequence.Body>
                              </p:AppOnlySequence>
                              <Assign>
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">
                                    <mca:CSharpReference x:TypeArguments="x:String">ApproveStatus</mca:CSharpReference>
                                  </OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">In Progress</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </State.Entry>
                          <State.Transitions>
                            <Transition DisplayName="T7" To="{x:Reference __ReferenceID3}" />
                          </State.Transitions>
                        </State>
                      </Transition.To>
                    </Transition>
                  </State.Transitions>
                </State>
              </Transition.To>
            </Transition>
          </State.Transitions>
        </State>
      </StateMachine.InitialState>
      <x:Reference>__ReferenceID4</x:Reference>
      <x:Reference>__ReferenceID2</x:Reference>
      <x:Reference>__ReferenceID3</x:Reference>
      <x:Reference>__ReferenceID5</x:Reference>
      <x:Reference>__ReferenceID1</x:Reference>
      <x:Reference>__ReferenceID6</x:Reference>
      <x:Reference>__ReferenceID7</x:Reference>
      <x:Reference>__ReferenceID0</x:Reference>
      <x:Reference>__ReferenceID8</x:Reference>
      <x:Reference>__ReferenceID9</x:Reference>
      <x:Reference>__ReferenceID10</x:Reference>
      <x:Reference>__ReferenceID11</x:Reference>
      <x:Reference>__ReferenceID12</x:Reference>
      <StateMachine.Variables>
        <Variable x:TypeArguments="x:Int32" Name="CurrentItemID" />
        <Variable x:TypeArguments="x:String" Name="CurrentListID" />
        <Variable x:TypeArguments="s:Guid" Name="CurrentListGUID" />
        <Variable x:TypeArguments="x:String" Name="Title" />
        <Variable x:TypeArguments="x:String" Name="LeaveType" />
        <Variable x:TypeArguments="x:Double" Name="NumberOfDay" />
        <Variable x:TypeArguments="x:String" Name="LeaveStatus" />
        <Variable x:TypeArguments="x:String" Name="OfficerManager" />
        <Variable x:TypeArguments="sco:Collection(x:String)" Name="listHrApprove" />
        <Variable x:TypeArguments="x:String" Name="CurrentSiteUrl" />
        <Variable x:TypeArguments="x:String" Name="ApproveStatus" />
        <Variable x:TypeArguments="p1:DynamicValue" Name="dynamichr" />
        <Variable x:TypeArguments="x:String" Name="RequestType" />
        <Variable x:TypeArguments="x:String" Name="CancelLeaveStatus" />
        <Variable x:TypeArguments="x:String" Name="TitleManagerEmail" />
        <Variable x:TypeArguments="x:String" Name="BodyManagerEmail" />
        <Variable x:TypeArguments="x:String" Name="setStatusRequest" />
        <Variable x:TypeArguments="x:String" Name="RequesterId" />
        <Variable x:TypeArguments="x:String" Name="TitleRequesterEmail" />
        <Variable x:TypeArguments="x:String" Name="BodyRequesterEmail" />
        <Variable x:TypeArguments="x:String" Name="TitleHREmail" />
        <Variable x:TypeArguments="x:String" Name="BodyHrEmail" />
        <Variable x:TypeArguments="x:String" Name="CurrentAppUrl" />
        <Variable x:TypeArguments="x:String" Name="CurrentHostUrl" />
        <Variable x:TypeArguments="x:String" Name="CurrentUrl" />
      </StateMachine.Variables>
      <sads:DebugSymbol.Symbol>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</sads:DebugSymbol.Symbol>
    </StateMachine>
  </tlwl:Workflow.Implementation>
</tlwl:Workflow>